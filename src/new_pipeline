import pandas as pd
import numpy as np
import sys
from sklearn.metrics.pairwise import pairwise_distances

attr = pd.read_csv('../data/clean_files/attr_FL.csv')
ben = pd.read_csv('../data/clean_files/benefits_covered_FL.csv')
zip = pd.read_csv('../data/clean_files/zipcodes.csv')

attr.drop(['Unnamed: 0','Issuer_ID'], axis=1, inplace=True)
attr.drop(['Issuer_Denial_rate','Plan_denial_rate','Disenrollment_Rate'], axis=1, inplace=True)


attr=attr.sort_values(by=['IssuerId', 'ServiceAreaId'])
merged_ben_attr = ben.merge(attr, how='left', on='PlanId')
merge_clean=merged_ben_attr.dropna()
merge_clean['Osteo']= merge_clean['Osteoporosis']+merge_clean['Osteoporosis Treatment']

merge_clean3=merge_clean.drop(['Osteoporosis','Osteoporosis Treatment','StandardComponentId','IssuerId','NetworkId',
                              'ServiceAreaId','PlanType','MetalLevel','PlanVariantMarketingName','Issuer_Name',
                               'No Management Program'],axis=1)

merge_clean3.rename(columns={'Osteo':'Osteoporosis'}, inplace=True)

plans=merge_clean3[[']]